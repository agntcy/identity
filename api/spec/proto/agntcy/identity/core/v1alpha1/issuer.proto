// Copyright 2025 Copyright AGNTCY Contributors (https://github.com/agntcy)
// SPDX-License-Identifier: Apache-2.0

// This file was autogenerated by go-to-protobuf. Do not edit it manually!

syntax = "proto3";

package agntcy.identity.core.v1alpha1;

import "agntcy/identity/core/v1alpha1/id.proto";

// Package-wide variables from generator "generated".
option go_package = "github.com/agntcy/identity/api/server/agntcy/identity/core/v1alpha1;identity_core_sdk_go";

// A Identity Issuer
message Issuer {
  // The organization of the issuer
  optional string organization = 1;

  // The sub organization of the issuer
  optional string sub_organization = 2;

  // The common name of the issuer
  // Could be a FQDN or a FQDA
  optional string common_name = 3;

  // This will be set to true when issuer provides a valid proof of ownership
  // of the common name on registration
  optional bool verified = 6;

  // This field is optional
  // The keys of the issuer in JWK format
  // The public key is used to verify the signature of the different claims
  optional .agntcy.identity.core.v1alpha1.Jwk public_key = 4;

  // This field is optional
  // The private key of the issuer in JWK format
  optional .agntcy.identity.core.v1alpha1.Jwk private_key = 5;

  // This field specifies the authentication mechanism used by the issuer.
  // It determines whether the issuer uses an external Identity Provider (IDP)
  // or a self-issued key for authentication.
  optional IssuerAuthType auth_type = 7;
}

// IssuerAuthType represents the type of authentication mechanism used by the issuer.
enum IssuerAuthType {
  // ISSUER_AUTH_TYPE_UNSPECIFIED represents an unspecified or unknown authentication type.
  ISSUER_AUTH_TYPE_UNSPECIFIED = 0;
  // ISSUER_AUTH_TYPE_IDP indicates that the issuer uses an external Identity Provider (IDP)
  // to authenticate
  ISSUER_AUTH_TYPE_IDP = 1;
  // ISSUER_AUTH_TYPE_SELF indicates that the issuer uses a self-issued key for authentication.
  // This is typically used in scenarios where the issuer doesn't rely on an IdP.
  ISSUER_AUTH_TYPE_SELF = 2;
}
